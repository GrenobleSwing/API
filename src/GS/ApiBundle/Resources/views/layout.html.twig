{% extends "::base.html.twig" %}

{% block menu %}
    {{ parent() }}

    {% if is_granted("ROLE_PRIVILEGED") %}
        {{ knp_menu_render('GSApiBundle:Builder:mainMenu', {'currentClass': 'active', 'template': 'GSApiBundle:Menu:knp_menu.html.twig'}) }}
        {% if is_granted("ROLE_ORGANIZER") %}
            {{ knp_menu_render('GSApiBundle:Builder:organizerMenu', {'currentClass': 'active', 'template': 'GSApiBundle:Menu:knp_menu.html.twig'}) }}
        {% endif %}
    {% endif %}

    {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
        <a href="{{ path('fos_user_security_logout') }}" class="btn btn-default navbar-btn navbar-right">DÃ©connexion</a>

        {% if is_granted('ROLE_PREVIOUS_ADMIN') %}
            <a href="{{ path('homepage', {'_switch_user': '_exit'}) }}" class="btn btn-default navbar-btn navbar-right">Exit impersonation</a>
        {% endif %}

        <p class="navbar-text navbar-right" style="margin-right:10px;">
            {{ 'layout.logged_in_as'|trans({'%username%': app.user.username}, 'FOSUserBundle') }}
        </p>
    {% else %}
        <a href="{{ path('fos_user_security_login') }}" class="btn btn-default navbar-btn navbar-right">Connexion</a>
{#        <a href="{{ path('fos_user_registration_register') }}" class="btn btn-default navbar-btn navbar-right">Inscription</a>#}
    {% endif %}

{% endblock %}

{% block body %}

    {% for type in ['info', 'success', 'danger', 'warning'] %}
        {% for message in app.session.flashbag.get(type) %}
            <div class="alert alert-{{ type }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}

    {% block gs_body %}
    {% endblock %}

{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">

    {% stylesheets filter='cssrewrite'
        '@GSApiBundle/Resources/public/css/*'
    %}
        <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

    {% javascripts filter='?jsqueeze'
        '@GSApiBundle/Resources/public/js/*'
    %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

    <script>
        $.fn.select2.defaults.set( "theme", "bootstrap" );
    </script>
{% endblock %}
